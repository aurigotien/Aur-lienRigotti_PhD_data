### Relaxation of granular media ###
    
## Computation ## 
 
    # Neighbor computation
    compute      voisin all contact/atom # compute number of neighbor  at d = dmin of the center of each grains
    compute      moy_voisin all reduce ave c_voisin # mean of the neighbor over all the grains
    
    # Stress of the system
    compute      sigma_relax all stress/atom NULL virial  # computation of the stress tensor componenent for each atoms
    compute      moy_sigma_relax all reduce sum c_sigma_relax[*] # sum the stress tensor over every atoms
    
     # Kinetic energy of the grains
    compute      nrj_cin all ke/atom
    compute      moy_nrj_cin all reduce ave c_nrj_cin[*]
    
    # Grains movement
    compute      u_relax all displace/atom
    compute      u_moy_relax all reduce ave c_u_relax[*][*]
    
    # Temp√©rature 
    compute      temperature all temp/sphere
  
## Variable ## 

    variable     sigma_relax_xx equal c_moy_sigma_relax[1]
    variable     sigma_relax_yy equal c_moy_sigma_relax[2]
    variable     sigma_relax_xy equal c_moy_sigma_relax[4]
    variable     p_relax equal "(c_moy_sigma_relax[1]+c_moy_sigma_relax[2])/2"
    
## Output command ##
    
    thermo       5000 # output every 5 000 step of time
    thermo_style custom step atoms c_temperature c_moy_voisin &
                 density press c_u_moy_relax[1] c_u_moy_relax[2] &
                 lx ly c_moy_nrj_cin &
                 v_sigma_relax_xx v_sigma_relax_yy v_sigma_relax_xy &
                 v_p_relax
    
    #dump		 relaxation_img all image 100000 relaxation.*.jpg type type &
    #             zoom 1.6 adiam 4.0
    #dump_modify	 relaxation_img pad 5
    
	#dump         relaxation all movie 500 relaxation.avi type type &
    #             zoom 1.6 adiam 4.0 # create a video of the relaxation
    #dump_modify relaxation pad 5 
    
## Relaxation of the sample ##

    # Beginning of the simulation
    timestep    1E-5 # simulation time step
    
    fix         relaxation all nph/sphere &
                iso 4E3 4E3 1E3 disc
    
	fix         2Dsimu all enforce2d # ensure 2D simulation by zeroing strenght/speed in z direction

    
## End of relaxation ##

     run         500000 #  500 000  step of simulation
     
### End of relaxation step ###       
   